!function(e){var t={};function a(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(o,r,function(t){return e[t]}.bind(null,r));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){e.exports=a(1)},function(e,t,a){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}!function(e,t){var a=e.plugins.registerPlugin,c=e.i18n.__,s=e.editPost.PluginDocumentSettingPanel,u=e.components,l=u.PanelRow,p=u.DateTimePicker,d=u.CheckboxControl,f=u.SelectControl,g=u.FormTokenField,y=u.Spinner,m=e.element,b=m.Fragment,x=m.Component,v=e.htmlEntities.decodeEntities,h=lodash,E=h.isEmpty,P=h.keys,S=h.compact;a("postexpirator-sidebar",{render:function(a){function u(){n(this,u);var e=i(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments));return e.state={categoriesList:[],catIdVsName:[]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,a),r(u,[{key:"componentWillMount",value:function(){var a,o=this,r=(this.state.attributes,e.data.select("core/editor").getEditedPostAttribute("meta")),n=e.data.select("core/editor").getCurrentPostType(),i=1==t.defaults.autoEnable,s=new Date,u=this.getExpireType(r),l=[];if(u.includes("category")&&(l=this.getCategories(r)),r["_expiration-date-status"]&&"saved"===r["_expiration-date-status"]&&(i=!0),r["_expiration-date"])s.setTime(1e3*(r["_expiration-date"]+60*s.getTimezoneOffset()));else if(l=t.default_categories,t.default_date){s.setTime(1e3*(parseInt(t.default_date)+60*s.getTimezoneOffset()));a={"_expiration-date":this.getDate(s)},e.data.dispatch("core/editor").editPost({meta:a})}var p=t.defaults.taxonomy||"category";this.setState({enabled:i,date:s,expireAction:u,categories:l,taxonomy:p});var d=[],f=[];!p&&"post"===n||"category"===p?e.apiFetch({path:e.url.addQueryArgs("wp/v2/categories",{per_page:-1,hide_empty:!1})}).then((function(e){e.forEach((function(e){d[e.name]=e,f[e.id]=e.name})),o.setState({categoriesList:d,catIdVsName:f,taxonomy:c("Category")})})):"page"!==n&&e.apiFetch({path:e.url.addQueryArgs("wp/v2/taxonomies/"+p,{context:"edit"})}).then((function(t){e.apiFetch({path:e.url.addQueryArgs("wp/v2/"+t.rest_base,{context:"edit"})}).then((function(e){e.forEach((function(e){d[v(e.name)]=e,f[e.id]=v(e.name)})),o.setState({categoriesList:d,catIdVsName:f,taxonomy:v(t.name)})}))}))}},{key:"componentDidUpdate",value:function(){var t=this.state,a=t.enabled,o=t.date,r=t.expireAction,n=t.categories,i=function(t){return e.data.dispatch("core/editor").editPost({meta:t})};switch(t.attribute){case"enabled":i({"_expiration-date-status":a?"saved":""});break;case"date":"string"==typeof o&&i({"_expiration-date":this.getDate(o)});break;case"action":i({"_expiration-date-type":r}),r.includes("category")||i({"_expiration-date-categories":[]});break;case"category":i({"_expiration-date-categories":n})}}},{key:"render",value:function(){var t=this,a=this.state,o=a.categoriesList,r=a.catIdVsName,n=this.state,i=n.enabled,u=n.date,m=n.expireAction,x=n.categories,v=n.taxonomy,h=e.data.select("core/editor").getCurrentPostType(),k=[{label:c("Draft","post-expirator"),value:"draft"},{label:c("Delete","post-expirator"),value:"delete"},{label:c("Trash","post-expirator"),value:"trash"},{label:c("Private","post-expirator"),value:"private"},{label:c("Stick","post-expirator"),value:"stick"},{label:c("Unstick","post-expirator"),value:"unstick"}];"page"!==h&&(k=_.union(k,[{label:c("Category: Replace","post-expirator"),value:"category"},{label:c("Category: Add","post-expirator"),value:"category-add"},{label:c("Category: Remove","post-expirator"),value:"category-remove"}]));var w=x&&S(x.map((function(e){return r[e]||!1})));return"string"==typeof w&&(w=[]),React.createElement(s,{title:c("Post Expirator","post-expirator"),icon:"calendar",initialOpen:i},React.createElement(l,null,React.createElement(d,{label:c("Enable Post Expiration","post-expirator"),checked:i,onChange:function(e){t.setState({enabled:!i,attribute:"enabled"})}})),i&&React.createElement(b,null,React.createElement(l,null,React.createElement(p,{currentDate:u,onChange:function(e){return t.setState({date:e,attribute:"date"})},is12Hour:!0})),React.createElement(f,{label:c("How to expire","post-expirator"),value:m,options:k,onChange:function(e){t.setState({expireAction:e,attribute:"action"})}}),m.includes("category")&&(E(P(o))&&React.createElement(b,null,c("Loading","post-expirator")+" ("+v+")",React.createElement(y,null))||React.createElement(g,{label:c("Expiration Categories","post-expirator")+" ("+v+")",value:w,suggestions:Object.keys(o),onChange:function(e){t.setState({categories:t.selectCategories(e),attribute:"category"})},maxSuggestions:10}))))}},{key:"getExpireType",value:function(e){var t=e["_expiration-date-type"],a=e["_expiration-date-options"]&&e["_expiration-date-options"].expireType;return t||(a||"draft")}},{key:"getCategories",value:function(e){var t=e["_expiration-date-categories"]&&e["_expiration-date-categories"],a=e["_expiration-date-options"]&&e["_expiration-date-options"].category;return"object"===(void 0===t?"undefined":o(t))&&t.length>0?t:(a&&void 0!==a&&"object"!==(void 0===a?"undefined":o(a))&&(categories=[a]),a)}},{key:"selectCategories",value:function(e){var t=this.state,a=t.categoriesList;t.catIdVsName;if(!e.some((function(e){return"string"==typeof e&&!a[e]})))return e.map((function(e){return"string"==typeof e?a[e]:e})).map((function(e){return e.id}))}},{key:"getDate",value:function(e){var t=new Date;return t.setTime(Date.parse(e)),t.setTime(t.getTime()-60*(new Date).getTimezoneOffset()*1e3),t.getTime()/1e3}}]),u}(x)})}(window.wp,config)}]);
//# sourceMappingURL=block.js.map