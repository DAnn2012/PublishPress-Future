{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/jsx/block.jsx"],"names":["wp","config","registerPlugin","plugins","__","i18n","PluginDocumentSettingPanel","editPost","components","PanelRow","DateTimePicker","CheckboxControl","SelectControl","FormTokenField","Spinner","element","Fragment","Component","decodeEntities","htmlEntities","lodash","isEmpty","keys","compact","PostExpiratorSidebar","arguments","state","categoriesList","catIdVsName","attributes","postMeta","data","select","getEditedPostAttribute","postType","getCurrentPostType","enabled","defaults","autoEnable","date","Date","expireAction","getExpireType","categories","includes","getCategories","setTime","getTimezoneOffset","default_categories","default_date","parseInt","taxonomy","setState","apiFetch","path","url","addQueryArgs","per_page","then","list","forEach","cat","name","id","context","taxAttributes","rest_base","terms","term","attribute","setPostMeta","newMeta","dispatch","meta","getDate","actionsList","label","value","_","union","selectedCats","map","Object","selectCategories","typeNew","typeOld","expireType","categoriesNew","categoriesOld","length","tokens","hasNoSuggestion","some","token","newDate","parse","getTime","render","window"],"mappings":"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","file":"block.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","(function (wp, config) {\n\n    const {registerPlugin} = wp.plugins;\n    const {__} = wp.i18n;\n    const {PluginDocumentSettingPanel} = wp.editPost;\n    const {PanelRow, DateTimePicker, CheckboxControl, SelectControl, FormTokenField, Spinner} = wp.components;\n    const {Fragment, Component} = wp.element;\n    const {decodeEntities} = wp.htmlEntities;\n    const {isEmpty, keys, compact} = lodash;\n\n    class PostExpiratorSidebar extends Component {\n        constructor() {\n            super(...arguments);\n\n            this.state = {\n                categoriesList: [],\n                catIdVsName: [],\n            }\n        }\n\n        componentWillMount() {\n            const {attributes} = this.state;\n\n            const postMeta = wp.data.select('core/editor').getEditedPostAttribute('meta');\n            const postType = wp.data.select('core/editor').getCurrentPostType();\n\n            let enabled = config.defaults.autoEnable == 1;\n            let date = new Date();\n\n            let expireAction = this.getExpireType(postMeta);\n\n            let categories = [];\n            if (expireAction.includes('category')) {\n                categories = this.getCategories(postMeta);\n            }\n\n            if (postMeta['_expiration-date-status'] && postMeta['_expiration-date-status'] === 'saved') {\n                enabled = true;\n            }\n\n            if (postMeta['_expiration-date']) {\n                date.setTime((postMeta['_expiration-date'] + date.getTimezoneOffset() * 60) * 1000);\n            } else {\n                categories = config.default_categories;\n                if (config.default_date) {\n                    date.setTime((parseInt(config.default_date) + date.getTimezoneOffset() * 60) * 1000);\n                }\n            }\n\n            let taxonomy = config.defaults.taxonomy || 'category';\n\n            this.setState({\n                enabled: enabled,\n                date: date,\n                expireAction: expireAction,\n                categories: categories,\n                taxonomy: taxonomy,\n            });\n\n            let categoriesList = [];\n            let catIdVsName = [];\n\n            if ((!taxonomy && postType === 'post') || taxonomy === 'category') {\n                wp.apiFetch({\n                    path: wp.url.addQueryArgs('wp/v2/categories', {per_page: -1}),\n                }).then((list) => {\n                    list.forEach(cat => {\n                        categoriesList[cat.name] = cat;\n                        catIdVsName[cat.id] = cat.name;\n                    });\n                    this.setState({categoriesList: categoriesList, catIdVsName: catIdVsName, taxonomy: __('Category')});\n                });\n            } else if (postType !== 'page') {\n                wp.apiFetch({\n                    path: wp.url.addQueryArgs(`wp/v2/taxonomies/${taxonomy}`, {context: 'edit'}),\n                }).then((taxAttributes) => {\n                    // fetch all terms\n                    wp.apiFetch({\n                        path: wp.url.addQueryArgs(`wp/v2/${taxAttributes.rest_base}`, {context: 'edit'}),\n                    }).then((terms) => {\n                        terms.forEach(term => {\n                            categoriesList[decodeEntities(term.name)] = term;\n                            catIdVsName[term.id] = decodeEntities(term.name);\n                        });\n                        this.setState({\n                            categoriesList: categoriesList,\n                            catIdVsName: catIdVsName,\n                            taxonomy: decodeEntities(taxAttributes.name)\n                        });\n                    });\n                });\n            }\n\n        }\n\n        componentDidUpdate() {\n            const {enabled, date, expireAction, categories, attribute} = this.state;\n            const setPostMeta = (newMeta) => wp.data.dispatch('core/editor').editPost({meta: newMeta});\n            const postMeta = wp.data.select('core/editor').getEditedPostAttribute('meta');\n\n            switch (attribute) {\n                case 'enabled':\n                    setPostMeta({'_expiration-date-status': (enabled ? 'saved' : '')});\n                    // if date is not set when the checkbox is enabled, set it to the default date\n                    // this is to prevent the user from having to click the date to set it\n                    if (!postMeta['_expiration-date']) {\n                        setPostMeta({'_expiration-date': this.getDate(date)});\n                    }\n                    break;\n                case 'date':\n                    if (typeof date === 'string') {\n                        setPostMeta({'_expiration-date': this.getDate(date)});\n                    }\n                    break;\n                case 'action':\n                    setPostMeta({'_expiration-date-type': expireAction});\n                    if (!expireAction.includes('category')) {\n                        setPostMeta({'_expiration-date-categories': []});\n                    }\n                    break;\n                case 'category':\n                    setPostMeta({'_expiration-date-categories': categories});\n                    break;\n            }\n\n        }\n\n        render() {\n            const {categoriesList, catIdVsName} = this.state;\n            const {enabled, date, expireAction, categories, taxonomy} = this.state;\n\n            const postType = wp.data.select('core/editor').getCurrentPostType();\n\n            let actionsList = [\n                {label: __('Draft', 'post-expirator'), value: 'draft'},\n                {label: __('Delete', 'post-expirator'), value: 'delete'},\n                {label: __('Trash', 'post-expirator'), value: 'trash'},\n                {label: __('Private', 'post-expirator'), value: 'private'},\n                {label: __('Stick', 'post-expirator'), value: 'stick'},\n                {label: __('Unstick', 'post-expirator'), value: 'unstick'},\n            ];\n\n            if (postType !== 'page') {\n                actionsList = _.union(actionsList, [\n                    {label: __('Category: Replace', 'post-expirator'), value: 'category'},\n                    {label: __('Category: Add', 'post-expirator'), value: 'category-add'},\n                    {label: __('Category: Remove', 'post-expirator'), value: 'category-remove'},\n                ]);\n            }\n\n            let selectedCats = categories && compact(categories.map((id) => catIdVsName[id] || false));\n            if (typeof selectedCats === 'string') {\n                selectedCats = [];\n            }\n\n            return (\n                <PluginDocumentSettingPanel title={__('Post Expirator', 'post-expirator')} icon=\"calendar\"\n                                            initialOpen={enabled} className={'post-expirator-panel'}>\n                    <PanelRow>\n                        <CheckboxControl\n                            label={__('Enable Post Expiration', 'post-expirator')}\n                            checked={enabled}\n                            onChange={(value) => {\n                                this.setState({enabled: !enabled, attribute: 'enabled'})\n                            }}\n                        />\n                    </PanelRow>\n                    {enabled && (\n                        <Fragment>\n                            <PanelRow>\n                                <DateTimePicker\n                                    currentDate={date}\n                                    onChange={(value) => this.setState({date: value, attribute: 'date'})}\n                                    is12Hour={true}\n                                />\n                            </PanelRow>\n                            <SelectControl\n                                label={__('How to expire', 'post-expirator')}\n                                value={expireAction}\n                                options={actionsList}\n                                onChange={(value) => {\n                                    this.setState({expireAction: value, attribute: 'action'})\n                                }}\n                            />\n                            {expireAction.includes('category') &&\n                            (\n                                (isEmpty(keys(categoriesList)) && (\n                                    <Fragment>\n                                        {__('Loading', 'post-expirator') + ` (${taxonomy})`}\n                                        <Spinner/>\n                                    </Fragment>\n                                ))\n                                ||\n                                (\n                                    <FormTokenField\n                                        label={__('Expiration Categories', 'post-expirator') + ` (${taxonomy})`}\n                                        value={selectedCats}\n                                        suggestions={Object.keys(categoriesList)}\n                                        onChange={(value) => {\n                                            this.setState({\n                                                categories: this.selectCategories(value),\n                                                attribute: 'category'\n                                            })\n                                        }}\n                                        maxSuggestions={10}\n                                    />\n                                )\n                            )}\n                        </Fragment>\n                    )}\n                </PluginDocumentSettingPanel>\n            );\n        }\n\n        // what action to take on expiration\n        getExpireType(postMeta) {\n            let typeNew = postMeta['_expiration-date-type'];\n            let typeOld = postMeta['_expiration-date-options'] && postMeta['_expiration-date-options']['expireType'];\n\n\n\n            if (typeNew) {\n                return typeNew;\n            }\n\n            if (typeOld) {\n                return typeOld;\n            }\n\n            if (config && config.defaults && config.defaults.expireType) {\n                return config.defaults.expireType;\n            }\n\n            return 'draft';\n        }\n\n        // what categories to add/remove/replace\n        getCategories(postMeta) {\n            let categoriesNew = postMeta['_expiration-date-categories'] && postMeta['_expiration-date-categories'];\n            let categoriesOld = postMeta['_expiration-date-options'] && postMeta['_expiration-date-options']['category'];\n\n            if (typeof categoriesNew === 'object' && categoriesNew.length > 0) {\n                return categoriesNew;\n            }\n\n            if (categoriesOld && typeof categoriesOld !== 'undefined' && typeof categoriesOld !== 'object') {\n                categories = [categoriesOld];\n            }\n\n            return categoriesOld;\n\n        }\n\n        // fired for the autocomplete\n        selectCategories(tokens) {\n            const {categoriesList, catIdVsName} = this.state;\n\n            var hasNoSuggestion = tokens.some(function (token) {\n                return typeof token === 'string' && !categoriesList[token];\n            });\n\n            if (hasNoSuggestion) {\n                return;\n            }\n\n            var categories = tokens.map(function (token) {\n                return typeof token === 'string' ? categoriesList[token] : token;\n            })\n\n            return categories.map((cat) => cat.id);\n        }\n\n        getDate(date) {\n            let newDate = new Date();\n            newDate.setTime(Date.parse(date));\n            newDate.setTime(newDate.getTime() - new Date().getTimezoneOffset() * 60 * 1000);\n            return ((newDate.getTime()) / 1000);\n        }\n\n    }\n\n    registerPlugin('postexpirator-sidebar', {\n        render: PostExpiratorSidebar\n    });\n\n\n})(window.wp, config);\n"],"sourceRoot":""}