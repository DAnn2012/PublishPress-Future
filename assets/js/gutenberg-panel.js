(()=>{"use strict";var e=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){u=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(u)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};!function(n,r){var u,o=n.plugins.registerPlugin,i=n.editPost.PluginDocumentSettingPanel,a=n.components,s=a.PanelRow,c=a.DateTimePicker,f=a.CheckboxControl,l=a.SelectControl,m=a.FormTokenField,T=a.Spinner,p=n.element.Fragment,A=n.htmlEntities.decodeEntities,y=lodash,g=y.isEmpty,E=y.keys,d=y.compact,h=React.useEffect,_=n.url.addQueryArgs,b=n.data,F=b.useSelect,x=b.useDispatch,N=b.register,D=b.createReduxStore,S=b.select,v=n.apiFetch,R=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),u=1;u<t;u++)n[u-1]=arguments[u];var o;console&&r.isDebugEnabled&&(o=console).debug.apply(o,["[Future]",e].concat(n))},I=(u={futureAction:null,futureActionDate:new Date,futureActionEnabled:!1,futureActionTerms:[],futureActionTaxonomy:null,termsListByName:null,termsListById:null,taxonomyName:null,isFetchingTerms:!1},r&&r.postTypeDefaultConfig?(r.postTypeDefaultConfig.autoEnable&&(u.futureActionEnabled=!0),r.postTypeDefaultConfig.expireType&&(u.futureAction=r.postTypeDefaultConfig.expireType),r.defaultDate?u.futureActionDate=new Date(r.defaultDate):u.futureActionDate=new Date,r.postTypeDefaultConfig.taxonomy&&(u.futureActionTaxonomy=r.postTypeDefaultConfig.taxonomy),r.postTypeDefaultConfig.terms&&(u.futureActionTerms=r.postTypeDefaultConfig.terms.split(",").map((function(e){return parseInt(e)}))),u):u);R("DEFAULT_STATE",I);var C=D("publishpress-future/store",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,n=arguments[1];switch(n.type){case"SET_FUTURE_ACTION":return t({},e,{futureAction:n.futureAction});case"SET_FUTURE_ACTION_DATE":return t({},e,{futureActionDate:n.futureActionDate});case"SET_FUTURE_ACTION_ENABLED":return t({},e,{futureActionEnabled:n.futureActionEnabled});case"SET_FUTURE_ACTION_TERMS":return t({},e,{futureActionTerms:n.futureActionTerms});case"SET_FUTURE_ACTION_TAXONOMY":return t({},e,{futureActionTaxonomy:n.futureActionTaxonomy});case"SET_TERMS_LIST_BY_NAME":return t({},e,{termsListByName:n.termsListByName});case"SET_TERMS_LIST_BY_ID":return t({},e,{termsListById:n.termsListById});case"SET_TAXONOMY_NAME":return t({},e,{taxonomyName:n.taxonomyName})}return e},actions:{setFutureAction:function(e){return{type:"SET_FUTURE_ACTION",futureAction:e}},setFutureActionDate:function(e){return{type:"SET_FUTURE_ACTION_DATE",futureActionDate:new Date(e)}},setFutureActionEnabled:function(e){return{type:"SET_FUTURE_ACTION_ENABLED",futureActionEnabled:e}},setFutureActionTerms:function(e){return{type:"SET_FUTURE_ACTION_TERMS",futureActionTerms:e}},setFutureActionTaxonomy:function(e){return{type:"SET_FUTURE_ACTION_TAXONOMY",futureActionTaxonomy:e}},setTermsListByName:function(e){return{type:"SET_TERMS_LIST_BY_NAME",termsListByName:e}},setTermsListById:function(e){return{type:"SET_TERMS_LIST_BY_ID",termsListById:e}},setTaxonomyName:function(e){return{type:"SET_TAXONOMY_NAME",taxonomyName:e}},setIsFetchingTerms:function(e){return{type:"SET_IS_FETCHING_TERMS",isFetchingTerms:e}}},selectors:{getFutureAction:function(e){return e.futureAction},getFutureActionDate:function(e){return e.futureActionDate},getFutureActionEnabled:function(e){return e.futureActionEnabled},getFutureActionTerms:function(e){return e.futureActionTerms},getFutureActionTaxonomy:function(e){return e.futureActionTaxonomy},getTermsListByName:function(e){return e.termsListByName},getTermsListById:function(e){return e.termsListById},getTaxonomyName:function(e){return e.taxonomyName},getIsFetchingTerms:function(e){return e.isFetchingTerms}}});N(C),o("publishpress-future-action",{render:function(){var t=F((function(e){return e("publishpress-future/store").getFutureAction()}),[]),n=F((function(e){return e("publishpress-future/store").getFutureActionDate()}),[]),u=F((function(e){return e("publishpress-future/store").getFutureActionEnabled()}),[]),o=F((function(e){return e("publishpress-future/store").getFutureActionTerms()}),[]),a=F((function(e){return e("publishpress-future/store").getFutureActionTaxonomy()}),[]),y=F((function(e){return e("publishpress-future/store").getTermsListByName()}),[]),b=F((function(e){return e("publishpress-future/store").getTermsListById()}),[]),N=F((function(e){return e("publishpress-future/store").getIsFetchingTerms()}),[]),D=x("publishpress-future/store"),C=D.setFutureAction,O=D.setFutureActionDate,w=D.setFutureActionEnabled,B=D.setFutureActionTerms,L=D.setFutureActionTaxonomy,U=D.setTermsListByName,M=D.setTermsListById,P=D.setTaxonomyName,k=D.setIsFetchingTerms,Y=x("core/editor").editPost,j=function(e){w(e);var t={enabled:e};e&&(C(I.futureAction),O(I.futureActionDate),B(I.futureActionTerms),L(I.futureActionTaxonomy),t.action=I.futureAction,t.date=I.futureActionDate,t.terms=I.futureActionTerms,t.taxonomy=I.futureActionTaxonomy,X()),H(t)},X=function(){R("fetchTerms","Fetching terms...");var e=S("publishpress-future/store").getFutureActionTaxonomy(),t=S("core/editor").getCurrentPostType(),n={},u={};k(!0),R("futureActionTaxonomy",e),!e&&"post"===t||"category"===e?(R("fetchTerms","Fetching categories..."),v({path:_("wp/v2/categories",{per_page:-1})}).then((function(e){R("list",e),e.forEach((function(e){n[e.name]=e,u[e.id]=e.name})),U(n),M(u),P(r.strings.category),k(!1)}))):(R("fetchTerms","Fetching taxonomies..."),v({path:_("publishpress-future/v1/taxonomies/"+t)}).then((function(t){R("response",t),parseInt(t.count)>0?v({path:_("wp/v2/taxonomies/"+e,{context:"edit",per_page:-1})}).then((function(e){R("taxAttributes",e),v({path:_("wp/v2/"+e.rest_base,{context:"edit",per_page:-1})}).then((function(t){R("terms",t),t.forEach((function(e){n[A(e.name)]=e,u[e.id]=A(e.name)})),U(n),M(u),P(A(e.name)),k(!1)}))})):R("fetchTerms","No taxonomies found")})))},H=function(r){var i={publishpress_future_action:{enabled:u,date:n,action:t,terms:o,taxonomy:a,browser_timezone_offset:(new Date).getTimezoneOffset()}},s=!0,c=!1,f=void 0;try{for(var l,m=Object.entries(r)[Symbol.iterator]();!(s=(l=m.next()).done);s=!0){var T=l.value,p=e(T,2),A=p[0],y=p[1];i.publishpress_future_action[A]=y}}catch(e){c=!0,f=e}finally{try{!s&&m.return&&m.return()}finally{if(c)throw f}}Y(i),R("editPostAttribute",r,i)};h((function(){var e;e=S("core/editor").getEditedPostAttribute("publishpress_future_action"),R("fetchFutureActionData",e),w(e.enabled).then(undefined),C(e.action),O(e.date),B(e.terms),L(e.taxonomy);var t=S("publishpress-future/store").getFutureActionEnabled(),n=S("core/editor").isCleanNewPost();R("enabled",t),R("isCleanNewPost",n),t&&(n&&j(!0),X())}),[]);var z=[];R("futureActionTerms",o),o&&o.length>0&&b&&"string"==typeof(z=d(o.map((function(e){return b[e]}))))&&(z=[]);var W=new Date(n);return R("futureActionDate",n),R("currentDate",W),React.createElement(i,{title:r.strings.panelTitle,icon:"calendar",initialOpen:u,className:"post-expirator-panel"},React.createElement(s,null,React.createElement(f,{label:r.strings.enablePostExpiration,checked:u,onChange:j})),u&&React.createElement(p,null,React.createElement(s,{className:"future-action-date-panel"},React.createElement(c,{currentDate:W,onChange:function(e){var t=new Date(e);O(t),H({date:t})},__nextRemoveHelpButton:!0,is12Hour:r.is12hours,startOfWeek:r.startOfWeek})),React.createElement(l,{label:r.strings.action,value:t,options:r.actionsSelectOptions,onChange:function(e){C(e),H({action:e})}}),String(t).includes("category")&&(N&&React.createElement(p,null,r.strings.loading+" ("+a+")",React.createElement(T,null))||!a&&React.createElement("p",null,React.createElement("i",{className:"dashicons dashicons-warning"})," ",r.strings.noTaxonomyFound)||g(E(y))&&React.createElement("p",null,React.createElement("i",{className:"dashicons dashicons-warning"})," ",r.strings.noTermsFound)||React.createElement(m,{label:r.taxonomyName,value:z,suggestions:Object.keys(y),onChange:function(e){e=e.map((function(e){return y[e].id})),B(e),H({terms:e})},maxSuggestions:10}))))}})}(window.wp,window.postExpiratorPanelConfig)})();
//# sourceMappingURL=gutenberg-panel.js.map