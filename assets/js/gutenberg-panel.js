(()=>{"use strict";var e=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){u=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(u)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};!function(n,r){var u,o=n.plugins.registerPlugin,i=n.editPost.PluginDocumentSettingPanel,s=n.components,a=s.PanelRow,c=s.DateTimePicker,f=s.CheckboxControl,l=s.SelectControl,m=s.FormTokenField,T=s.Spinner,p=n.element.Fragment,A=n.htmlEntities.decodeEntities,y=lodash,g=y.isEmpty,E=y.keys,d=y.compact,h=React.useEffect,_=n.url.addQueryArgs,b=n.data,F=b.useSelect,x=b.useDispatch,N=b.register,S=b.createReduxStore,D=b.select,v=n.apiFetch,I=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),u=1;u<t;u++)n[u-1]=arguments[u];var o;console&&r.isDebugEnabled&&(o=console).debug.apply(o,["[Future]",e].concat(n))},R=(u={futureAction:null,futureActionDate:0,futureActionEnabled:!1,futureActionTerms:[],futureActionTaxonomy:null,termsListByName:null,termsListById:null,taxonomyName:null,isFetchingTerms:!1},r&&r.postTypeDefaultConfig?(r.postTypeDefaultConfig.autoEnable&&(u.futureActionEnabled=!0),r.postTypeDefaultConfig.expireType&&(u.futureAction=r.postTypeDefaultConfig.expireType),r.defaultDate?u.futureActionDate=parseInt(r.defaultDate):u.futureActionDate=(new Date).getTime(),r.postTypeDefaultConfig.taxonomy&&(u.futureActionTaxonomy=r.postTypeDefaultConfig.taxonomy),r.postTypeDefaultConfig.terms&&(u.futureActionTerms=r.postTypeDefaultConfig.terms.split(",").map((function(e){return parseInt(e)}))),u):u);I("DEFAULT_STATE",R);var C=S("publishpress-future/store",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,n=arguments[1];switch(n.type){case"SET_FUTURE_ACTION":return t({},e,{futureAction:n.futureAction});case"SET_FUTURE_ACTION_DATE":return t({},e,{futureActionDate:n.futureActionDate});case"SET_FUTURE_ACTION_ENABLED":return t({},e,{futureActionEnabled:n.futureActionEnabled});case"SET_FUTURE_ACTION_TERMS":return t({},e,{futureActionTerms:n.futureActionTerms});case"SET_FUTURE_ACTION_TAXONOMY":return t({},e,{futureActionTaxonomy:n.futureActionTaxonomy});case"SET_TERMS_LIST_BY_NAME":return t({},e,{termsListByName:n.termsListByName});case"SET_TERMS_LIST_BY_ID":return t({},e,{termsListById:n.termsListById});case"SET_TAXONOMY_NAME":return t({},e,{taxonomyName:n.taxonomyName})}return e},actions:{setFutureAction:function(e){return{type:"SET_FUTURE_ACTION",futureAction:e}},setFutureActionDate:function(e){return{type:"SET_FUTURE_ACTION_DATE",futureActionDate:e}},setFutureActionEnabled:function(e){return{type:"SET_FUTURE_ACTION_ENABLED",futureActionEnabled:e}},setFutureActionTerms:function(e){return{type:"SET_FUTURE_ACTION_TERMS",futureActionTerms:e}},setFutureActionTaxonomy:function(e){return{type:"SET_FUTURE_ACTION_TAXONOMY",futureActionTaxonomy:e}},setTermsListByName:function(e){return{type:"SET_TERMS_LIST_BY_NAME",termsListByName:e}},setTermsListById:function(e){return{type:"SET_TERMS_LIST_BY_ID",termsListById:e}},setTaxonomyName:function(e){return{type:"SET_TAXONOMY_NAME",taxonomyName:e}},setIsFetchingTerms:function(e){return{type:"SET_IS_FETCHING_TERMS",isFetchingTerms:e}}},selectors:{getFutureAction:function(e){return e.futureAction},getFutureActionDate:function(e){return e.futureActionDate},getFutureActionEnabled:function(e){return e.futureActionEnabled},getFutureActionTerms:function(e){return e.futureActionTerms},getFutureActionTaxonomy:function(e){return e.futureActionTaxonomy},getTermsListByName:function(e){return e.termsListByName},getTermsListById:function(e){return e.termsListById},getTaxonomyName:function(e){return e.taxonomyName},getIsFetchingTerms:function(e){return e.isFetchingTerms}}});N(C),o("publishpress-future-action",{render:function(){var t=F((function(e){return e("publishpress-future/store").getFutureAction()}),[]),n=F((function(e){return e("publishpress-future/store").getFutureActionDate()}),[]),u=F((function(e){return e("publishpress-future/store").getFutureActionEnabled()}),[]),o=F((function(e){return e("publishpress-future/store").getFutureActionTerms()}),[]),s=F((function(e){return e("publishpress-future/store").getFutureActionTaxonomy()}),[]),y=F((function(e){return e("publishpress-future/store").getTermsListByName()}),[]),b=F((function(e){return e("publishpress-future/store").getTermsListById()}),[]),N=F((function(e){return e("publishpress-future/store").getIsFetchingTerms()}),[]),S=x("publishpress-future/store"),C=S.setFutureAction,O=S.setFutureActionDate,B=S.setFutureActionEnabled,L=S.setFutureActionTerms,U=S.setFutureActionTaxonomy,w=S.setTermsListByName,M=S.setTermsListById,P=S.setTaxonomyName,k=S.setIsFetchingTerms,Y=x("core/editor").editPost,j=function(e){B(e);var t={enabled:e};e&&(C(R.futureAction),O(R.futureActionDate),L(R.futureActionTerms),U(R.futureActionTaxonomy),t.action=R.futureAction,t.date=R.futureActionDate,t.terms=R.futureActionTerms,t.taxonomy=R.futureActionTaxonomy,X()),H(t)},X=function(){I("fetchTerms","Fetching terms...");var e=D("publishpress-future/store").getFutureActionTaxonomy(),t=D("core/editor").getCurrentPostType(),n={},u={};k(!0),I("futureActionTaxonomy",e),!e&&"post"===t||"category"===e?(I("fetchTerms","Fetching categories..."),v({path:_("wp/v2/categories",{per_page:-1})}).then((function(e){I("list",e),e.forEach((function(e){n[e.name]=e,u[e.id]=e.name})),w(n),M(u),P(r.strings.category),k(!1)}))):(I("fetchTerms","Fetching taxonomies..."),v({path:_("publishpress-future/v1/taxonomies/"+t)}).then((function(t){I("taxonomies",t.taxonomies),t.taxonomies.length>0?v({path:_("wp/v2/taxonomies/"+e,{context:"edit",per_page:-1})}).then((function(e){I("taxAttributes",e),v({path:_("wp/v2/"+e.rest_base,{context:"edit",per_page:-1})}).then((function(t){I("terms",t),t.forEach((function(e){n[A(e.name)]=e,u[e.id]=A(e.name)})),w(n),M(u),P(A(e.name)),k(!1)}))})):I("fetchTerms","No taxonomies found")})))},H=function(r){var i={publishpress_future_action:{enabled:u,date:n,action:t,terms:o,taxonomy:s}},a=!0,c=!1,f=void 0;try{for(var l,m=Object.entries(r)[Symbol.iterator]();!(a=(l=m.next()).done);a=!0){var T=l.value,p=e(T,2),A=p[0],y=p[1];i.publishpress_future_action[A]=y}}catch(e){c=!0,f=e}finally{try{!a&&m.return&&m.return()}finally{if(c)throw f}}Y(i),I("editPostAttribute",r,i)};h((function(){var e;e=D("core/editor").getEditedPostAttribute("publishpress_future_action"),B(e.enabled).then(undefined),C(e.action),O(e.date),L(e.terms),U(e.taxonomy);var t=D("publishpress-future/store").getFutureActionEnabled(),n=D("core/editor").isCleanNewPost();I("enabled",t),I("isCleanNewPost",n),t&&(n&&j(!0),X())}),[]);var W=[];return I("futureActionTerms",o),o&&o.length>0&&b&&"string"==typeof(W=d(o.map((function(e){return b[e]}))))&&(W=[]),React.createElement(i,{title:r.strings.panelTitle,icon:"calendar",initialOpen:u,className:"post-expirator-panel"},React.createElement(a,null,React.createElement(f,{label:r.strings.enablePostExpiration,checked:u,onChange:j})),u&&React.createElement(p,null,React.createElement(a,null,React.createElement(c,{currentDate:1e3*n,onChange:function(e){var t=new Date(e).getTime()/1e3;O(t),H({date:t})},__nextRemoveHelpButton:!0,is12Hour:r.is12hours,startOfWeek:r.startOfWeek})),React.createElement(l,{label:r.strings.action,value:t,options:r.actionsSelectOptions,onChange:function(e){C(e),H({action:e})}}),String(t).includes("category")&&(N&&React.createElement(p,null,r.strings.loading+" ("+s+")",React.createElement(T,null))||g(E(y))&&React.createElement("p",null,React.createElement("i",{className:"dashicons dashicons-warning"})," ",r.strings.noTermsFound)||React.createElement(m,{label:r.strings.terms+" ("+s+")",value:W,suggestions:Object.keys(y),onChange:function(e){e=e.map((function(e){return y[e].id})),L(e),H({terms:e})},maxSuggestions:10}))))}})}(window.wp,window.postExpiratorPanelConfig)})();
//# sourceMappingURL=gutenberg-panel.js.map